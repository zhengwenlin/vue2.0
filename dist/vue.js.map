{"version":3,"file":"vue.js","sources":["../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observer/dep.js","../src/utils.js","../src/observer/schedular.js","../src/observer/watcher.js","../src/vdom/index.js","../src/vdom/patch.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/render.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["// 将ast转换成code代码，代码长什么样子\r\n/*\r\n/* \r\n<div id=\"app\" a=1 b=2>\r\n    <span style\"=color:red\">{{name}} <a>hello</a></span>\r\n</div> \r\n _c(\r\n    'div',{id:'app',a:1,b:2}\r\n    ,_c(\r\n        'span',\r\n        {style:{color:'red'}}\r\n        ,_s(_v(name)),\r\n        _c(a,undefined,_v('hello'))\r\n        )\r\n)\r\n  三种函数：\r\n  _c 创建元素\r\n  _s stringflfy转成字符串\r\n  _v 处理文本\r\n  _c(\r\n      'div', {id:'app', a:1,b:2},\r\n      _c('span', {style: {color:\"red\"}}, _s(_v(name)), _c('a', undefined, _v('hello')))\r\n  )\r\n*/\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // 匹配{{}}\r\n// 生成子元素\r\nfunction genChilren(el) {\r\n    let children = el.children \r\n    if(children){\r\n        return children.map(child => gen(child)).join(',')\r\n    }\r\n}\r\nfunction gen(node){\r\n    if(node.type === 3){\r\n        //文本\r\n        //文本比较复杂了，文本中可能有1.普通文本或者2.带大括号的 {{name}}aa{{age}}哈哈\r\n        // _v(_s(name) + 'aa' + _s(age) + '哈哈')\r\n        // {{aa}} aaa {{bbb}} ccc\r\n        // 第一次：aa  index: 0   lastIndex:6\r\n        let text = node.text;\r\n        if(defaultTagRE.test(text)){\r\n            //带有{{}}的\r\n            // 全局模式下，exec方法重置正则对象的lastIndex为0\r\n            let lastIndex = defaultTagRE.lastIndex = 0; \r\n            let match; //匹配的结果\r\n            let index = 0; //index属性值\r\n            let tokens = []\r\n            //只要能匹配到{{}}，就一直循环\r\n            while(match = defaultTagRE.exec(text)) {\r\n                // match[0]匹配到的字符串 1-n 分组结果\r\n                // index match[0]第一个字符在原字符串中的索引位置\r\n                index = match.index;\r\n                if(index > lastIndex){\r\n                   // index > lastIndex 说明没有匹配到，说明是普通文本\r\n                   tokens.push(JSON.stringify(text.slice(lastIndex,index)));\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`)\r\n                lastIndex = index + match[0].length;\r\n            }\r\n\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join(\"+\")})`\r\n        }else{\r\n            // 普通文本\r\n            return `_v(${JSON.stringify(text)})`\r\n        }\r\n    }else if(node.type === 1){\r\n        //标签\r\n        return generate(node)\r\n    }\r\n}\r\n// 生成属性 [{naem:xx,value:xxx}]\r\nfunction genProps(attrs){\r\n    let str = ''\r\n    for(let i = 0; i< attrs.length; i++){\r\n       let attr = attrs[i]\r\n       if(attr.name === 'style'){\r\n         let temp = attr.value; // style=\"color:red;background:pink\"\r\n         let obj = {}\r\n         temp.split(';').forEach(s => {\r\n             let [sName,sValue] = s.split(':')\r\n             obj[sName] = sValue;\r\n         })\r\n         attr.value = obj;\r\n\r\n       }\r\n       str += `${attr.name}:${JSON.stringify(attr.value)},`  \r\n    }\r\n    return `{${str.slice(0, -1)}}` \r\n}\r\nexport function generate(el) {\r\n    let code = `_c('${el.tag}', ${\r\n        el.attrs&&el.attrs.length ? genProps(el.attrs): 'undefined'\r\n    } ${\r\n        el.children ? (',' + genChilren(el)): ''\r\n    })`\r\n    return code;\r\n}\r\n\r\n","\r\n// 将html模板转成ast语法树,核心就是正则匹配，截取字符串\r\n\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aa \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 可以匹配到标签名  [1]\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //[0] 标签的结束名字\r\n//    style=\"xxx\"   style='xxx'  style=xxx\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\n// ast语法树长什么样？\r\n/*\r\n   {\r\n       tag, // 标签名\r\n       type, //类型\r\n       attrs,// 属性\r\n       parent, // 父节点\r\n       children //孩子节点\r\n   }\r\n*/\r\n\r\n/**\r\n * \r\n    <div id=\"1\" a=\"2\">\r\n        <span style=\"color:red;\">{{name}}}</span>\r\n        <span>haha{{age}}}world</span>\r\n    </div>\r\n</div>\r\n */\r\n// 创建ast对象\r\nfunction createAstElement(tag,attrs){\r\n    return {\r\n        tag,\r\n        type:1,\r\n        attrs,\r\n        parent: null,\r\n        children: []\r\n    }\r\n}\r\n//这个函数最终是要得到一个ast语法树\r\nexport function parseHTML(html) {\r\n    // ast的根，默认是null\r\n    let root = null;\r\n    let stack = [] // 使用栈结构存放ast元素，记录父子关系\r\n    let currentParent = null; //当前的父元素\r\n    //处理开始标签的\r\n    function start(tagName, attrs){\r\n        let element = createAstElement(tagName,attrs)\r\n        if(!root){\r\n           root = element\r\n        }\r\n        stack.push(element)\r\n        currentParent = element;\r\n\r\n    }\r\n    //处理结束标签的\r\n    function end(tagName){\r\n        // 这里用来处理父子关系\r\n        let element = stack.pop() //取出最后一个\r\n        currentParent = stack[stack.length - 1] // 父级就是前一个元素\r\n        if(currentParent){\r\n            element.parent = currentParent;\r\n            currentParent.children.push(element)\r\n        }\r\n    }\r\n    //处理文本的\r\n    function charts(text){\r\n      text = text.replace(/\\s/g, '')\r\n      //空文本不做处理\r\n      if(text){\r\n        currentParent.children.push({\r\n            type: 3,\r\n            text\r\n        })\r\n      }\r\n    }\r\n    // 走n步\r\n    function advance(n) {\r\n        html = html.substring(n)\r\n    }\r\n    // 解析标签\r\n    function parseStartTag() {\r\n        let match = html.match(startTagOpen)\r\n        if (match) {\r\n            advance(match[0].length)\r\n            let matched = {\r\n                tagName: match[1],\r\n                attrs: []\r\n            }\r\n            //解析属性\r\n            //属性可能有多个，属性的位置 >前的\r\n            let end, attr\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                advance(attr[0].length)\r\n                matched.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n                return matched;\r\n            }\r\n            \r\n        }\r\n    }\r\n\r\n    while (html) {\r\n        // indexOf() 方法可返回某个指定的字符串值在字符串中首次出现的位置。\r\n        let textEnd = html.indexOf('<')\r\n        // 如果textEnd == 0的话，说明是标签； >0的话，说明是文本\r\n        if (textEnd === 0) {\r\n            //开始标签\r\n            let startTagMatch = parseStartTag()\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n            }\r\n            //结束标签\r\n            let endTagMatch = html.match(endTag)\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length)\r\n                end(endTagMatch[1])\r\n            }\r\n        }\r\n\r\n        // 匹配文本 从0-匹配到>的位置都是文本的部分\r\n        let text;\r\n        if (textEnd > 0) {\r\n            text = html.substring(0, textEnd)\r\n        }\r\n        if (text) {\r\n            advance(text.length)\r\n            charts(text)\r\n        }\r\n    }\r\n    return root;\r\n}","// 将模板编译成render函数\r\n\r\nimport { generate } from \"./generate\";\r\nimport { parseHTML } from \"./parse\";\r\n\r\n\r\nexport function compileToFunctions(template) {\r\n    // 将html模板转成ast语法树\r\n    let ast = parseHTML(template)\r\n\r\n    // 将ast 转换成code\r\n    let code = generate(ast)\r\n    \r\n    // with生成render代码\r\n    let renderCode = `with(this){ return ${code}}`\r\n\r\n    // 生成render函数\r\n    let fn = new Function(renderCode)\r\n\r\n    return fn\r\n}","\r\n// dep主要用来保存watcher和让watcher更新\r\nlet id = 0;\r\nexport class Dep {\r\n    constructor(){\r\n        this.subs = []\r\n        this.id = id++;\r\n    }\r\n    \r\n    // 让watcher记住这个dep\r\n    depend(){\r\n       Dep.target.addDep(this) \r\n    }\r\n\r\n    //添加一个watcher\r\n    addSub(watcher){\r\n        this.subs.push(watcher)\r\n    }\r\n    //让watcher触发更新\r\n    notify(){\r\n        this.subs.forEach(watcher=>watcher.update())\r\n    }\r\n}   \r\n\r\nDep.target = null; \r\nexport function pushTarget(watcher){\r\n    Dep.target = watcher;\r\n}\r\n\r\nexport function popTarget(){\r\n   Dep.target = null;\r\n}","\r\nlet callbacks = []\r\nlet waiting = false;\r\nfunction flushCallbacks() {\r\n    for (let i = 0; i < callbacks.length; i++) {\r\n        let callback = callbacks[i]\r\n        callback()\r\n    }\r\n    callbacks = []\r\n    waiting = false;\r\n}\r\n// 批处理 只更新列表， 之后执行更新逻辑\r\nexport function nextTick(cb) {\r\n    callbacks.push(cb)\r\n    if (!waiting) {\r\n        waiting = true;\r\n        Promise.resolve().then(flushCallbacks)\r\n    }\r\n\r\n}\r\nconst LIFECYCLE_HOOKS = [\r\n    'beforeCreate',\r\n    'created',\r\n    'beforeMount',\r\n    'mounted',\r\n    'beforeUpdate',\r\n    'updated',\r\n    'beforeDestory',\r\n    'destored'\r\n]\r\n//策略模式\r\nconst strats = {}\r\n//合并生命周期方法\r\n//主要是将生命周期合并成一个数组\r\n//第一次  parentVal是空的  childVal有值\r\n//key肯定是生命周期名字，所以parentVal和childVal至少有一个有值，第一次parentVal为空，所以\r\n//调用这个方法时，childVal肯定有值\r\nfunction mergeHook(parentVal, childVal) {\r\n    if (childVal) {\r\n        if (parentVal) {\r\n            return parentVal.concat(childVal)\r\n        } else {\r\n            return [childVal]\r\n        }\r\n    } else {\r\n        return parentVal\r\n    }\r\n}\r\n//生命周期的处理策略\r\nLIFECYCLE_HOOKS.forEach(hook => {\r\n    strats[hook] = mergeHook // 合并生命周期函数 \r\n})\r\nexport function isObject(val) {\r\n    return typeof val === 'object' && val !== null;\r\n}\r\n\r\n\r\n// 组件compoents的合并策略\r\nstrats.components = function (parentVal, childVal) {\r\n    let res = Object.create(parentVal)\r\n    for(let key in childVal){\r\n        res[key] = childVal[key]\r\n    }\r\n    return res;\r\n}\r\n\r\n\r\n// 合并选项\r\nexport function mergeOptions(parent, child) {\r\n    let options = {}\r\n    //1. 普通属性的合并策略\r\n    //如果父亲有，儿子也有，就用儿子的\r\n    //如果父亲有，儿子没有，就用父亲的\r\n    //如果父亲没有，而儿子有，就用儿子的\r\n    for (let key in parent) {\r\n        mergeField(key)\r\n    }\r\n\r\n    for (let key in child) {\r\n        if (!parent.hasOwnProperty(key)) {\r\n            mergeField(key)\r\n        }\r\n    }\r\n\r\n    function mergeField(key) {\r\n        //key有可能是生命周期钩子 beforecreate created\r\n        //非普通属性的策略模式，钩子函数、directive component\r\n        if (strats[key]) {\r\n            return options[key] = strats[key](parent[key], child[key])\r\n        }\r\n\r\n\r\n        //如果parent[key] child[key]都是对象，就用儿子的覆盖父亲的\r\n        if (isObject(parent[key]) && isObject(child[key])) {\r\n            options[key] = { ...parent[key], ...child[key] }\r\n        } else {\r\n            //合并以儿子为主\r\n            if (child[key]) {\r\n                options[key] = child[key]\r\n            } else {\r\n                options[key] = parent[key]\r\n            }\r\n        }\r\n    }\r\n\r\n    return options;\r\n}\r\n\r\nfunction makeUp(str) {\r\n    let has = {}\r\n    str.split(',').forEach(tagName => {\r\n        has[tagName] = true;\r\n    })\r\n\r\n    return (tag) => has[tag] || false;\r\n}\r\n\r\n// 是否是原生标签 高阶函数\r\nexport const isReservedTag = makeUp('a,p,div,ul,li,span,input,button,b')","import { nextTick } from \"../utils\";\r\n\r\n\r\nlet queue = []\r\nlet has = {}\r\nlet pending = false;\r\n\r\nfunction flushSchedularQueue(){\r\n   for(let i =0; i< queue.length; i++) {\r\n       let watcher = queue[i]\r\n       watcher.run()\r\n   }\r\n   queue = []\r\n   has = {}\r\n   pending = false;\r\n}\r\nexport function queueWatcher(watcher){\r\n    let id = watcher.id;\r\n    if(!has[id]){\r\n        queue.push(watcher)\r\n        has[id] = true;\r\n  \r\n        if(!pending){\r\n            pending = true; //进入等待状态\r\n            //如果不是等待状态,异步执行数组中的watcher\r\n            nextTick(flushSchedularQueue)\r\n        }\r\n    }\r\n}","\r\nimport { pushTarget, popTarget } from './dep'\r\nimport { queueWatcher } from './schedular';\r\nlet id = 0; \r\nclass Watcher{\r\n   constructor(vm, exprOrFn, cb, options){\r\n       this.id = id++;\r\n       this.vm = vm;\r\n       this.cb = cb;\r\n       this.options = options;\r\n       this.getter = exprOrFn;\r\n\r\n       this.deps = []\r\n       this.depsId = new Set() //dep的id  set数据\r\n\r\n       this.get()\r\n   }\r\n   // watcher中保存着dep\r\n   addDep(dep){\r\n      //watcher中不存放相同的dep\r\n      let id = dep.id;\r\n      if(!this.depsId.has(id)){ //dep是非重复的，watcher也是不会重复的\r\n        this.depsId.add(id)\r\n        this.deps.push(dep)\r\n        dep.addSub(this)\r\n      }\r\n   }\r\n   //为什么叫get呢，表示这个方法中会对模板中的数据进行取值\r\n   get(){\r\n      //更新前，将这个watcher(渲染watcher)放到Depd.target属性上\r\n      pushTarget(this) //Dep.target = watcher\r\n      //getter方法走的是更新方法 vm._update(vm._render())\r\n      this.getter() //调用getter方法，会对模板中的数据进行取值操作\r\n      //更新后，重置为null, 防止在模板外修改数据，减少不必要的更新\r\n      popTarget() //Dep.target = null\r\n   }\r\n   //真正的更新方法\r\n   run(){\r\n      this.get()\r\n   }\r\n   //更新操作\r\n   //现在是同步更新，改一次，更新一次，希望是异步更新\r\n   update(){\r\n      //调度执行watcher的更新方法，而且是异步的\r\n      queueWatcher(this)\r\n   }\r\n}\r\n\r\nexport default Watcher;","import { isObject, isReservedTag } from \"../utils\"\r\n\r\n// _c('div', {a:1,b:2}, _c())\r\nexport function createElement(vm, tag, data={}, ...children){\r\n    // 这里的tag有可能是个组件，要区分是组件还是原生标签\r\n    if(isReservedTag(tag)){\r\n        return vnode(vm, tag, data, data.key, children, undefined)\r\n    }else{\r\n        let Ctor = vm.$options.components[tag]\r\n        return createComponent(vm, tag, data, data.key, children, Ctor)\r\n    }\r\n    \r\n}\r\n\r\nfunction createComponent(vm, tag, data, key, children, Ctor){\r\n    // Ctor有可能是一个对象或者函数\r\n    if(isObject(Ctor)){\r\n        Ctor = vm.$options._base.extend(Ctor)\r\n    }\r\n    // 给组件的虚拟dom的属性上添加一个hook生命周期方法\r\n    data.hook = {\r\n        init(vnode){\r\n            let child = vnode.componentInstance = new vnode.componentOptions.Ctor({})\r\n            child.$mount()\r\n        }\r\n    }\r\n    return vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, { Ctor })\r\n}\r\n\r\nexport function createTextNode(vm, text){\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\n\r\nfunction vnode(vm, tag, data, key, children, text, componentOptions){\r\n    return {\r\n        vm,\r\n        tag,\r\n        data,\r\n        key,\r\n        children,\r\n        text,\r\n        componentOptions\r\n    }\r\n}\r\n// tag和key一样说明是一个虚拟节点\r\nexport function isSameVnode(oldVnode, newVnode){\r\n    return oldVnode.tag === newVnode.tag && oldVnode.key === newVnode.key\r\n}","import { isSameVnode } from './index'\r\n// 创建组件的真实元素\r\nfunction createComponent(vnode) {\r\n    let i = vnode.data\r\n    if ((i = i.hook) && (i = i.init)) {\r\n        i(vnode)\r\n        if (vnode.componentInstance) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n// 给vnode虚拟节点创建真实节点，并且可以通过vnode.el获取到真实的节点\r\nexport function createElm(vnode) {\r\n    let { tag, data, key, children, text, vm } = vnode\r\n    if (typeof tag === 'string') {\r\n\r\n        //可能是组件，也可能是普通的元素\r\n\r\n        if (createComponent(vnode)) { // 返回组件的真实dom节点\r\n            return vnode.componentInstance.$el;\r\n        }\r\n        //创建标签\r\n        //虚拟节点的el属性上映射真实dom\r\n        vnode.el = document.createElement(tag)\r\n        //更新属性\r\n        updateProperties(vnode)\r\n        // 创建子节点\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createElm(child))\r\n        })\r\n    } else {\r\n        //创建文本\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\n\r\nfunction updateProperties(vnode, oldProps = {}) {\r\n    let newProps = vnode.data || {}\r\n    let elm = vnode.el;\r\n\r\n    // 1. 老的有，新的没有，干掉老的\r\n    for (let key in oldProps) {\r\n        if (!newProps[key]) { //移除老的属性\r\n            elm.removeAttribute(key)\r\n        }\r\n    }\r\n\r\n    //2. style一样\r\n    let oldStyle = oldProps.style || {}\r\n    let newStyle = newProps.style || {}\r\n\r\n    for (let key in oldStyle) {\r\n        if (!newStyle[key]) {\r\n            elm.style[key] = ''\r\n        }\r\n    }\r\n    //添加新的属性\r\n    Object.keys(newProps).forEach(key => {\r\n        if (key === 'style') {\r\n            for (let styleName in newProps['style']) {\r\n                elm.style[styleName] = newProps['style'][styleName]\r\n            }\r\n        } else if (key === 'class') {\r\n            elm.className = newProps['class']\r\n        } else {\r\n            elm.setAttribute(key, newProps[key])\r\n        }\r\n    })\r\n}\r\n\r\nfunction updateChildren(parent, oldChildren, newChildren) {\r\n    // vue中的diff都是同层节点的比对\r\n    // vue中的diff采用的是双指针的方式进行比较\r\n\r\n    // 1.创建双指针\r\n    let oldStartIndex = 0;\r\n    let oldEndIndex = oldChildren.length - 1;\r\n    let oldStartVnode = oldChildren[0]\r\n    let oldEndVnode = oldChildren[oldChildren.length - 1]\r\n\r\n    let newStartIndex = 0;\r\n    let newEndIndex = newChildren.length - 1;\r\n    let newStartVnode = newChildren[0]\r\n    let newEndVnode = newChildren[newChildren.length - 1]\r\n\r\n    // 因为乱序对比时，要看新的虚拟节点在老的中有没有，所以要创建一个老的key-index的映射表\r\n    // 通过key可以取到index，从而获取到这个vnode\r\n    function mkIndexByKey(oldChildren = []) {\r\n        let map = {}\r\n        oldChildren.forEach((child, index) => {\r\n            map[child.key] = index\r\n        })\r\n        return map\r\n    }\r\n    let map = mkIndexByKey(oldChildren)\r\n    // 2.不停的移动使用while循环，\r\n    // 条件是 oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex\r\n    while (oldStartIndex <= oldEndIndex && newStartIndex <= newEndIndex) {\r\n        // diff的优化策略\r\n        // 向后插入，向前插入，头移动到尾，尾移动到头部，正序和反序\r\n\r\n        if (!oldStartVnode) {\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n        } else if (!oldEndVnode) {\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n        } else if (isSameVnode(oldStartVnode, newStartVnode)) {\r\n            //1. 向后插入  ABCD -> ABCDE\r\n            // 如果是相同的元素，老的指针和新的指针都往后移动\r\n            // 调用patch，比较属性和儿子\r\n            patch(oldStartVnode, newStartVnode)\r\n            //指针向后移动\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n            newStartVnode = newChildren[++newStartIndex]\r\n\r\n        } else if (isSameVnode(oldEndVnode, newEndVnode)) {//2. 向前插入 ABCD -> EABCD\r\n            // 调用patch，比较属性和儿子\r\n            patch(oldEndVnode, newEndVnode)\r\n            //指针向后移动\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n            newEndVnode = newChildren[--newEndIndex]\r\n        } else if (isSameVnode(oldStartVnode, newEndVnode)) { // 3. 头移动尾部\r\n            patch(oldStartVnode, newEndVnode)\r\n            // 将老的开始的节点的元素插入到尾指针的下一个节点的前边\r\n            parent.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibiling)\r\n            // 老的开始的指针向后移动，新的结束指针向前移动\r\n            oldStartVnode = oldChildren[++oldStartIndex]\r\n            newEndVnode = newChildren[--newEndIndex]\r\n        } else if (isSameVnode(oldEndVnode, newStartVnode)) { // 4. 尾部移动头部\r\n            patch(oldEndVnode, newStartVnode)\r\n            // 将老的节点的结束节点移动到老的头部前边\r\n            parent.insertBefore(oldEndVnode.el, oldStartVnode.el)\r\n            oldEndVnode = oldChildren[--oldEndIndex]\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        } else { // 乱序比对\r\n            // 头和头、尾和尾 、头和尾、尾和头 都不一样，就使用乱序比对\r\n            // 乱序比对： 看看新的节点中，老的中有没有，有的话就复用，没有就创建新的\r\n\r\n            // 看看老的中有没有\r\n            let moveIndex = map[newStartVnode.key]\r\n            if (moveIndex === undefined) {\r\n                // 老的中没有，就创建新的，插入到老的开始位置的前边\r\n                parent.insertBefore(createElm(newStartVnode), oldStartVnode.el)\r\n\r\n            } else {\r\n                // 老的中有，就移动老的节点，将原来的重置为null空\r\n                let moveIndexVnode = oldChildren[moveIndex] // 要移动的节点\r\n                oldChildren[moveIndex] = undefined;\r\n                patch(moveIndexVnode, newStartVnode) // 复用老的节点，继续patch\r\n                parent.insertBefore(moveIndexVnode.el, oldStartVnode.el)\r\n            }\r\n            //新的start指针移动\r\n            newStartVnode = newChildren[++newStartIndex]\r\n        }\r\n    }\r\n    //如果新的多，要插入\r\n    if (newStartIndex <= newEndIndex) {\r\n        for (let i = newStartIndex; i <= newEndIndex; i++) {\r\n            let nextEle = newChildren[newEndIndex + 1] == null ? null : newChildren[newEndIndex + 1].el;\r\n            // appendChild 和 insertBefore 也可以进行合并\r\n            // 如果insertBefore 传入null 等价于appendChild\r\n            parent.insertBefore(createElm(newChildren[i]), nextEle)\r\n        }\r\n    }\r\n\r\n    //如果老的多，要删除\r\n    if (oldStartIndex <= oldEndIndex) {\r\n        for (let i = oldStartIndex; i <= oldEndIndex; i++) {\r\n            let current = oldChildren[i]\r\n            if (current != undefined) {\r\n                parent.removeChild(child.el)\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\nexport function patch(oldVnode, vnode) {\r\n    // 组件： oldVnode没有，就直接创建元素\r\n    if (!oldVnode) return createElm(vnode)\r\n    // 初次渲染，oldVnode是#app真实dom节点\r\n    const isRealElement = oldVnode.nodeType;\r\n\r\n    if (isRealElement) {\r\n        //初次渲染\r\n        let oldElm = oldVnode; // 老的真实dom节点\r\n        let parentNode = oldElm.parentNode; // 父节点\r\n        let el = createElm(vnode) // 根据虚拟节点创建出真实dom 新的真实dom\r\n\r\n        //将新的真实dom插入到老的节点下一个节点的前边\r\n        parentNode.insertBefore(el, oldElm.nextSibiling)\r\n\r\n        // 移除老的节点\r\n        parentNode.removeChild(oldElm)\r\n        //返回新的节点\r\n        return el;\r\n    } else {\r\n        //diff\r\n        // 1. 如果标签名都不一样，就不用比了，直接干掉老的，插入新的\r\n        if (oldVnode.tag !== vnode.tag) {\r\n            return oldVnode.el.parentNode.replaceChild(createElm(vnode), oldVnode.el)\r\n        }\r\n\r\n        // 2. 如果标签名相同，可能是文本 text: {tag:undefined}\r\n        // 文本内容不一样，用新的替换老的\r\n        if (!oldVnode.tag) {\r\n            if (oldVnode.text !== vnode.text) {\r\n                return oldVnode.el.textContent = vnode.text;\r\n            }\r\n        }\r\n        //3. 都是元素，标签名字相同，就复用老的节点\r\n        let el = vnode.el = oldVnode.el;\r\n        console.log(el, '**el**')\r\n        //属性可能不一样，老的属性和新的节点比对\r\n        updateProperties(vnode, oldVnode.data)\r\n        //4. 更新儿子\r\n        let oldChildren = oldVnode.children || []\r\n        let newChildren = vnode.children || []\r\n        // 1. 如果老的有儿子，新的也有 diff算法\r\n        if (oldChildren.length > 0 && newChildren.length > 0) {\r\n            updateChildren(el, oldChildren, newChildren)\r\n        } else if (oldChildren.length > 0) { // 2. 如果老的有儿子，新的没有，直接干掉老的\r\n            oldVnode.el.innerHTML = ''\r\n\r\n        } else if (newChildren.length > 0) { // 3. 如果老的没有儿子，新的有儿子，插入新的儿子\r\n            newChildren.forEach(child => el.appendChild(createElm(child)))\r\n        }\r\n\r\n\r\n    }\r\n\r\n}","\r\n// 挂载的逻辑，有了render函数，使用render函数生成vdom虚拟dom，然后渲染到页面上\r\n\r\nimport Watcher from \"./observer/watcher\"\r\nimport { patch } from \"./vdom/patch\";\r\n\r\nexport function lifecycleMixin(Vue) {\r\n    //将虚拟dom转换成真实dom渲染到页面\r\n    Vue.prototype._update = function (vnode) {\r\n        let vm = this;\r\n        const prevVnode = vm._vnode; // 保留上一次的vnode\r\n        vm._vnode = vnode;\r\n\r\n        if(!prevVnode){\r\n            // vm.$el是真实dom节点\r\n            vm.$el = patch(vm.$el, vnode)\r\n        }else{\r\n            vm.$el = patch(prevVnode,vnode); // 更新时做diff操作\r\n        }\r\n    }\r\n}\r\n\r\n\r\n// 渲染靠的是watcher  - 渲染watcher\r\nexport function mountComponent(vm, el) {\r\n    // 更新渲染组件的方法\r\n    const updateComponent = () => {\r\n        vm._update(vm._render())\r\n    }\r\n    // 使用渲染watcher渲染页面\r\n    new Watcher(vm, updateComponent, () => { }, true) // true为渲染watcher\r\n}\r\n\r\n/**\r\n * 调用声明周期钩子\r\n * @param {*} vm \r\n * @param {*} hook \r\n */\r\nexport function callHook(vm, hook) {\r\n    //vm.$options上可以获取到合并后的生命周期函数数组\r\n    const handlers = vm.$options[hook]\r\n    if (handlers) {\r\n        handlers.forEach(handler => handler.call(vm))\r\n    }\r\n}","// 数据劫持，数组的处理逻辑，主要是方法的重写\r\n\r\n// 老的数组的方法\r\nlet oldArrayMethods = Array.prototype;\r\n\r\n// 这7个方法都是能修改原数组的方法\r\nconst methods = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'splice',\r\n    'reverse',\r\n    'sort'\r\n]\r\n/**\r\n * 相当于\r\n * function create(proto){\r\n *   let Fn = function(){}\r\n *   Fn.prototype = proto\r\n *   return new Fn()\r\n * }\r\n * proto.__proto__ = Array.prototype 相当于多了一层\r\n */\r\nconst arrayMethods = Object.create(Array.prototype)\r\n\r\n// 重写数组的方法\r\n// 删除元素的方法不管，增加元素的方法，如果元素是对象，进行监测\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function(...args) {\r\n        // 调用老的方法\r\n        let result = oldArrayMethods[method].call(this, ...args)\r\n        let inserted;\r\n        let ob = this.__ob__ // Observer的实例\r\n        // 自己的逻辑\r\n        switch(method){\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice':  // splice(0, 1, xxx)\r\n                inserted = args.slice(2)\r\n            default:\r\n                break;\r\n        }\r\n        // 如果有插入的元素\r\n        if(inserted) {\r\n           // inserted是一个数组，数组中可能有插入的对象元素，监测数组\r\n           // 检测数组可以调用Observer的 observeArray 方法，但是需要得到Observer的实例\r\n           // 这里的this是什么，数组调用的方法，this指的是数组数据，可以将Observer实例挂载到this上\r\n           ob.observeArray(inserted)\r\n        }\r\n        //调用了数组的方法，更新视图\r\n        ob.dep.notify()\r\n        return result;\r\n        \r\n    }\r\n})\r\n// 导出重写后的方法\r\nexport default arrayMethods;","import arrayMethods from \"./array\"\r\nimport {Dep} from './dep'\r\nclass Observer {\r\n    constructor(data) { //data有可能是一个数组\r\n        //数组的依赖收集\r\n        this.dep = new Dep()\r\n        //这样写发现死循环了 Maximum call stack size exceeded\r\n        //因为data多了一个__ob__属性，walk的时候，循环data，ob是一个对象，又new Observer，又走walk，又\r\n        //有一个__ob__，就死循环了\r\n        //data.__ob__ = this; // 将this挂载到数据上\r\n        // 将__ob__变成不可枚举即可,使用Object.defineProperty\r\n        Object.defineProperty(data, '__ob__', {\r\n            value: this,\r\n            enumerable: false, //不能枚举\r\n            configurable: false //不能删除\r\n        })\r\n\r\n        // 如果数据是一个数组的话，默认会将数组的每一个元素都设置了get和set，性能差\r\n        // 默认数组单独处理\r\n        if (Array.isArray(data)) {\r\n            // 处理数组的逻辑 这里的data是数组，有数组的方法\r\n            // 1. 改写数组的方法（能修改原数组的方法）,因为如果原数组改变了，也应该触发视图更新\r\n            // 通过重写原型方法的方式 data.__proto__ = arrayMethods\r\n            Object.setPrototypeOf(data, arrayMethods)\r\n            // 2. 如果元素是对象，进行监测，如果是普通值，不管\r\n            this.observeArray(data)\r\n        } else {\r\n            this.walk(data)\r\n        }\r\n    }\r\n\r\n    // 观测数据，走一步\r\n    walk(data) {\r\n        // value是对象\r\n        Object.keys(data).forEach(key => {\r\n            // 定义响应式数据 obj  key  value\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n\r\n    // 数组元素监测\r\n    observeArray(data) {\r\n        for (let i = 0; i < data.length; i++) {\r\n            observe(data[i])\r\n        }\r\n    }\r\n}\r\n\r\nfunction dependArray(value){\r\n    for(let i = 0; i < value.length; i++){\r\n        let current = value[i]\r\n        //如果有__ob__属性，说明是对象或者数组，也要收集依赖\r\n        current.__ob__ && current.__ob__.dep.depend()\r\n\r\n        //如果这个元素是数组，递归收集\r\n        if(Array.isArray(current)){\r\n            dependArray(current)\r\n        }\r\n    }\r\n}\r\n\r\n// 将一个对象定义成响应式（Object.defineProperty）\r\nexport function defineReactive(obj, key, value) {\r\n    // value可能是对象\r\n    let childOb = observe(value) //observer的实例\r\n    let dep = new Dep() // 给每个属性都创建一个dep，用于收集依赖\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            //渲染的时候，js单线程机制，模板渲染会进行取值操作，走get方法\r\n            //让这个属性key能记住这个watcher\r\n            if(Dep.target){\r\n                // 对对象进行依赖收集,将Dep.target这个渲染watcher放到这个dep中\r\n                dep.depend() //让这个属性自己的dep记住这个watcher，也要让watcher记住这个dep\r\n                \r\n                if(childOb){ //收集数组或者对象本身的依赖 {arr:[]}\r\n                    childOb.dep.depend()\r\n                    //如果元素中也有数组，也要递归收集，将元素的依赖收集起来\r\n                    if(Array.isArray(value)){\r\n                        dependArray(value)\r\n                    }\r\n                }\r\n                \r\n            }\r\n            return value;\r\n        },\r\n        set(newVal) {\r\n            if (newVal === value) {\r\n                return;\r\n            }\r\n            // 设置的值可能是对象\r\n            observe(newVal)\r\n            value = newVal;\r\n\r\n            dep.notify()\r\n        }\r\n    })\r\n}\r\n\r\n// 观测数据，数据劫持\r\nexport function observe(data) {\r\n    // 如果不是对象的话，不管\r\n    if (typeof data !== 'object' || data === null) {\r\n        return;\r\n    }\r\n    // 如果数据有__ob__属性，说明被监测过了，不用再次监测\r\n    if (data.__ob__) {\r\n        return;\r\n    }\r\n    // 使用Observer类观测\r\n    return new Observer(data)\r\n\r\n}","import { observe } from \"./observer/index.js\";\r\n\r\n// 用于初始化状态，状态由很多种 props data methods computed watch\r\nexport function initState(vm) {\r\n  let options = vm.$options\r\n\r\n  // 初始化数据，数据劫持\r\n  if(options.data){\r\n      initData(vm)\r\n  }\r\n}\r\n\r\n// 将vm._data的数据代理的vm实例上，用户体验好\r\nfunction proxy(target, source, key){\r\n  Object.defineProperty(target, key, {\r\n    get(){\r\n      return target[source][key]\r\n    },\r\n    set(newValue){\r\n      target[source][key] = newValue;\r\n    }\r\n  })\r\n}\r\n\r\n// 初始化data数据\r\nfunction initData(vm) {\r\n    // 初始化数据，就是对数据的劫持\r\n    let data = vm.$options.data\r\n    // vm._data中保存着数据\r\n    data = vm._data = typeof data === 'function' ? data.call(vm): data;\r\n\r\n    // 用户看数据只能在vm._data上看，可以将vm._data上的数据代理到vm实例上，通过vm.xx访问数据\r\n    for(let key in data){\r\n       proxy(vm, '_data', key)\r\n    }\r\n\r\n    // 数据劫持，观测数据 data和vm._data是同一个引用\r\n    observe(data)\r\n\r\n}","import { compileToFunctions } from \"./compiler/index.js\";\r\nimport { callHook, mountComponent } from \"./lifecycle.js\";\r\nimport { mergeOptions, nextTick } from \"./utils.js\";\r\nimport { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        let vm = this;\r\n        // 将用户传入的选项和Vue.options进行合并\r\n        // vm.$options保存的是用户传入的选项\r\n        //将合并后的生命周期啥的配置项和用户传入的options合并，保存到了vm.$options上\r\n        vm.$options = mergeOptions(vm.constructor.options,options)\r\n        //初始化状态前 beforeCreate\r\n        callHook(vm, 'beforeCreate')\r\n        \r\n        //初始化状态有很多\r\n        initState(vm)\r\n\r\n        //初始化状态后  created\r\n        callHook(vm, 'created')\r\n\r\n        //编译模板，挂载到页面\r\n        if(vm.$options.el){\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    // nextTick方法\r\n    Vue.prototype.$nextTick = nextTick\r\n\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this;\r\n        let options = vm.$options;\r\n        \r\n        // 获取el的dom节点\r\n        el = typeof el === 'string' ? document.querySelector(el) : el;\r\n        // vm.$options.el是真实dom节点\r\n        vm.$el = el;\r\n\r\n        // 查找模板的顺序：\r\n        // 如果有render函数，直接使用render函数\r\n        // 没有render  看看有没有template\r\n        // 没有template 就使用外部模板\r\n\r\n        // 使用模板编译成render函数\r\n        if(!options.render){\r\n            let template = options.template\r\n            if(!template){\r\n                template = el.outerHTML // 外部模板\r\n            }\r\n\r\n            //拿到模板，使用模板编译成render函数\r\n            const render =  compileToFunctions(template)\r\n            options.render = render;\r\n        }\r\n\r\n\r\n        // 有了render函数，挂载页面(组件)\r\n        mountComponent(vm, el)\r\n\r\n    }\r\n}","import { createElement, createTextNode } from \"./vdom/index\"\r\n\r\nexport function renderMixin(Vue) {\r\n    \r\n    Vue.prototype._c = function (...args) {\r\n        return createElement(this, ...args)\r\n    }\r\n    Vue.prototype._v = function (text) {\r\n        return createTextNode(this, text)\r\n    }\r\n    Vue.prototype._s = function (val) {\r\n        return val == null ? '' : typeof val === 'object' ? JSON.stringify(val) : val;\r\n    }\r\n    Vue.prototype._render = function () {\r\n        const vm = this;\r\n        let render = vm.$options.render\r\n        let vnode = render.call(vm)\r\n        return vnode;\r\n    }\r\n}","import { mergeOptions } from \"../utils\";\r\n\r\n\r\nexport function initGlobalAPI(Vue) {\r\n    //用来存储全局的配置\r\n    Vue.options = {}\r\n    //混入，就是将这些配置项混入到用户传入的配置项中\r\n    //调用mixin方法，会将mixin配置项合并到Vue.options选项中\r\n    Vue.mixin = function (mixin) {\r\n        this.options = mergeOptions(this.options, mixin)\r\n        return this;\r\n    }\r\n    Vue.options._base = Vue // 保存Vue构造函数\r\n\r\n    //将所有的组件都保存到这个对象中\r\n    Vue.options.components = {}\r\n\r\n    //component方法\r\n    //Vue.component方法内部调用的Vue.extend方法，传入对象，返回组件的构造函数\r\n    Vue.component = function (id, definition) {\r\n        definition.name = definition.name || id;\r\n        //调用extend方法，返回组件的构造函数\r\n        definition = this.options._base.extend(definition)\r\n        //将组件的构造函数保存到Vue.options.components对象中\r\n        this.options.components[id] = definition\r\n    }\r\n    let cid = 0;\r\n    Vue.extend = function (options) {\r\n        let Super = this; //Super指向Vue\r\n        //创建Vue子类的构造函数\r\n        let Sub = function VueComponent(options) {\r\n            this._init(options)\r\n        }\r\n        Sub.cid = cid++;\r\n        // 原型继承\r\n        Sub.prototype = Object.create(Super.prototype)\r\n        Sub.prototype.constructor = Sub\r\n\r\n        // 拷贝静态方法\r\n        Sub.component = Super.component;\r\n\r\n        // 每次定义一个组件，这个组件应该能够父级的定义\r\n        Sub.options = mergeOptions(Super.options, options)\r\n        return Sub;\r\n    }\r\n}","import { initMixin } from \"./init\";\r\nimport { renderMixin } from './render'\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport { initGlobalAPI } from \"./global-api/index\";\r\nimport { compileToFunctions } from \"./compiler/index\";\r\nimport { patch,createElm  } from \"./vdom/patch\";\r\n// Vue的入口文件\r\nfunction Vue(options) {\r\n  this._init(options)\r\n}\r\n\r\n// 混入的初始化方法\r\n// 原型模式，将原型的方法拆分到不同的文件中\r\ninitMixin(Vue)\r\nlifecycleMixin(Vue) //在Vue原型上扩展_update方法\r\nrenderMixin(Vue) // 在Vue原型上扩展_render方法\r\n\r\n\r\ninitGlobalAPI(Vue) //混入全局方法\r\n\r\n\r\n\r\n// domdiff--------\r\n\r\n// let vm1 = new Vue({\r\n//   data() {\r\n//     return { name: 'zf' }\r\n//   }\r\n// })\r\n\r\n// let render1 = compileToFunctions(`<div>\r\n//   <li key=\"A\">A</li>\r\n//   <li key=\"D\">D</li>\r\n//   <li key=\"B\">B</li>\r\n//   <li key=\"E\">E</li>\r\n//   <li key=\"C\">C</li>\r\n// </div>`)\r\n// let vnode1 = render1.call(vm1)\r\n\r\n// let vm2 = new Vue({\r\n//   data() {\r\n//     return { name: 'zwl' }\r\n//   }\r\n// })\r\n// // 初次渲染后，才能做diff\r\n// let el = createElm(vnode1)\r\n// document.body.appendChild(el)\r\n// // diff\r\n// let render2 = compileToFunctions(`<div>\r\n//   <li key=\"D\">D</li>\r\n//   <li key=\"A\">A</li>\r\n//   <li key=\"B\">B</li>\r\n//   <li key=\"C\">C</li>\r\n//   <li key=\"E\">E</li>\r\n// </div>`)\r\n// let vnode2= render2.call(vm2)\r\n\r\n// setTimeout(() => {\r\n//   patch(vnode1, vnode2)\r\n// }, 2000)\r\n\r\nexport default Vue;"],"names":["defaultTagRE","genChilren","el","children","map","child","gen","join","node","type","text","test","lastIndex","match","index","tokens","exec","push","JSON","stringify","slice","trim","length","generate","genProps","attrs","str","i","attr","name","temp","value","obj","split","forEach","s","sName","sValue","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","parent","parseHTML","html","root","stack","currentParent","start","tagName","element","end","pop","charts","replace","advance","n","substring","parseStartTag","matched","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunctions","template","ast","renderCode","fn","Function","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","callbacks","waiting","flushCallbacks","callback","nextTick","cb","Promise","resolve","then","LIFECYCLE_HOOKS","strats","mergeHook","parentVal","childVal","concat","hook","isObject","val","components","res","Object","create","key","mergeOptions","options","mergeField","hasOwnProperty","makeUp","has","isReservedTag","queue","pending","flushSchedularQueue","run","queueWatcher","Watcher","vm","exprOrFn","getter","deps","depsId","Set","get","dep","add","addSub","createElement","data","vnode","undefined","Ctor","$options","createComponent","_base","extend","init","componentInstance","componentOptions","$mount","cid","createTextNode","isSameVnode","oldVnode","newVnode","createElm","$el","document","updateProperties","appendChild","oldProps","newProps","elm","removeAttribute","oldStyle","style","newStyle","keys","styleName","className","setAttribute","updateChildren","oldChildren","newChildren","oldStartIndex","oldEndIndex","oldStartVnode","oldEndVnode","newStartIndex","newEndIndex","newStartVnode","newEndVnode","mkIndexByKey","patch","insertBefore","nextSibiling","moveIndex","moveIndexVnode","nextEle","current","removeChild","isRealElement","nodeType","oldElm","parentNode","replaceChild","textContent","console","log","innerHTML","lifecycleMixin","Vue","prototype","_update","prevVnode","_vnode","mountComponent","updateComponent","_render","callHook","handlers","handler","call","oldArrayMethods","Array","methods","arrayMethods","method","args","result","inserted","ob","__ob__","observeArray","notify","Observer","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","defineReactive","observe","dependArray","depend","childOb","set","newVal","initState","initData","proxy","source","newValue","_data","initMixin","_init","constructor","$nextTick","querySelector","render","outerHTML","renderMixin","_c","_v","_s","initGlobalAPI","mixin","component","definition","Super","Sub","VueComponent"],"mappings":"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"}