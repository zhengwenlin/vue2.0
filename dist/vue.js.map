{"version":3,"file":"vue.js","sources":["../src/compiler/generate.js","../src/compiler/parse.js","../src/compiler/index.js","../src/observer/dep.js","../src/utils.js","../src/observer/schedular.js","../src/observer/watcher.js","../src/vdom/patch.js","../src/lifecycle.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/vdom/index.js","../src/render.js","../src/global-api/index.js","../src/index.js"],"sourcesContent":["// 将ast转换成code代码，代码长什么样子\r\n/*\r\n/* \r\n<div id=\"app\" a=1 b=2>\r\n    <span style\"=color:red\">{{name}} <a>hello</a></span>\r\n</div> \r\n _c(\r\n    'div',{id:'app',a:1,b:2}\r\n    ,_c(\r\n        'span',\r\n        {style:{color:'red'}}\r\n        ,_s(_v(name)),\r\n        _c(a,undefined,_v('hello'))\r\n        )\r\n)\r\n  三种函数：\r\n  _c 创建元素\r\n  _s stringflfy转成字符串\r\n  _v 处理文本\r\n  _c(\r\n      'div', {id:'app', a:1,b:2},\r\n      _c('span', {style: {color:\"red\"}}, _s(_v(name)), _c('a', undefined, _v('hello')))\r\n  )\r\n*/\r\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g // 匹配{{}}\r\n// 生成子元素\r\nfunction genChilren(el) {\r\n    let children = el.children \r\n    if(children){\r\n        return children.map(child => gen(child)).join(',')\r\n    }\r\n}\r\nfunction gen(node){\r\n    if(node.type === 3){\r\n        //文本\r\n        //文本比较复杂了，文本中可能有1.普通文本或者2.带大括号的 {{name}}aa{{age}}哈哈\r\n        // _v(_s(name) + 'aa' + _s(age) + '哈哈')\r\n        // {{aa}} aaa {{bbb}} ccc\r\n        // 第一次：aa  index: 0   lastIndex:6\r\n        let text = node.text;\r\n        if(defaultTagRE.test(text)){\r\n            //带有{{}}的\r\n            // 全局模式下，exec方法重置正则对象的lastIndex为0\r\n            let lastIndex = defaultTagRE.lastIndex = 0; \r\n            let match; //匹配的结果\r\n            let index = 0; //index属性值\r\n            let tokens = []\r\n            //只要能匹配到{{}}，就一直循环\r\n            while(match = defaultTagRE.exec(text)) {\r\n                // match[0]匹配到的字符串 1-n 分组结果\r\n                // index match[0]第一个字符在原字符串中的索引位置\r\n                index = match.index;\r\n                if(index > lastIndex){\r\n                   // index > lastIndex 说明没有匹配到，说明是普通文本\r\n                   tokens.push(JSON.stringify(text.slice(lastIndex,index)));\r\n                }\r\n                tokens.push(`_s(${match[1].trim()})`)\r\n                lastIndex = index + match[0].length;\r\n            }\r\n\r\n            if(lastIndex < text.length){\r\n                tokens.push(JSON.stringify(text.slice(lastIndex)))\r\n            }\r\n            return `_v(${tokens.join(\"+\")})`\r\n        }else{\r\n            // 普通文本\r\n            return `_v(${JSON.stringify(text)})`\r\n        }\r\n    }else if(node.type === 1){\r\n        //标签\r\n        return generate(node)\r\n    }\r\n}\r\n// 生成属性 [{naem:xx,value:xxx}]\r\nfunction genProps(attrs){\r\n    let str = ''\r\n    for(let i = 0; i< attrs.length; i++){\r\n       let attr = attrs[i]\r\n       if(attr.name === 'style'){\r\n         let temp = attr.value; // style=\"color:red;background:pink\"\r\n         let obj = {}\r\n         temp.split(';').forEach(s => {\r\n             let [sName,sValue] = s.split(':')\r\n             obj[sName] = sValue;\r\n         })\r\n         attr.value = obj;\r\n\r\n       }\r\n       str += `${attr.name}:${JSON.stringify(attr.value)},`  \r\n    }\r\n    return `{${str.slice(0, -1)}}` \r\n}\r\nexport function generate(el) {\r\n    let code = `_c('${el.tag}', ${\r\n        el.attrs&&el.attrs.length ? genProps(el.attrs): 'undefined'\r\n    } ${\r\n        el.children ? (',' + genChilren(el)): ''\r\n    })`\r\n    return code;\r\n}\r\n\r\n","\r\n// 将html模板转成ast语法树,核心就是正则匹配，截取字符串\r\n\r\nconst ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aa \r\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; //aa:aa\r\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 可以匹配到标签名  [1]\r\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); //[0] 标签的结束名字\r\n//    style=\"xxx\"   style='xxx'  style=xxx\r\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\r\nconst startTagClose = /^\\s*(\\/?)>/;\r\n// ast语法树长什么样？\r\n/*\r\n   {\r\n       tag, // 标签名\r\n       type, //类型\r\n       attrs,// 属性\r\n       parent, // 父节点\r\n       children //孩子节点\r\n   }\r\n*/\r\n\r\n/**\r\n * \r\n    <div id=\"1\" a=\"2\">\r\n        <span style=\"color:red;\">{{name}}}</span>\r\n        <span>haha{{age}}}world</span>\r\n    </div>\r\n</div>\r\n */\r\n// 创建ast对象\r\nfunction createAstElement(tag,attrs){\r\n    return {\r\n        tag,\r\n        type:1,\r\n        attrs,\r\n        parent: null,\r\n        children: []\r\n    }\r\n}\r\n//这个函数最终是要得到一个ast语法树\r\nexport function parseHTML(html) {\r\n    // ast的根，默认是null\r\n    let root = null;\r\n    let stack = [] // 使用栈结构存放ast元素，记录父子关系\r\n    let currentParent = null; //当前的父元素\r\n    //处理开始标签的\r\n    function start(tagName, attrs){\r\n        let element = createAstElement(tagName,attrs)\r\n        if(!root){\r\n           root = element\r\n        }\r\n        stack.push(element)\r\n        currentParent = element;\r\n\r\n    }\r\n    //处理结束标签的\r\n    function end(tagName){\r\n        // 这里用来处理父子关系\r\n        let element = stack.pop() //取出最后一个\r\n        currentParent = stack[stack.length - 1] // 父级就是前一个元素\r\n        if(currentParent){\r\n            element.parent = currentParent;\r\n            currentParent.children.push(element)\r\n        }\r\n    }\r\n    //处理文本的\r\n    function charts(text){\r\n      text = text.replace(/\\s/g, '')\r\n      //空文本不做处理\r\n      if(text){\r\n        currentParent.children.push({\r\n            type: 3,\r\n            text\r\n        })\r\n      }\r\n    }\r\n    // 走n步\r\n    function advance(n) {\r\n        html = html.substring(n)\r\n    }\r\n    // 解析标签\r\n    function parseStartTag() {\r\n        let match = html.match(startTagOpen)\r\n        if (match) {\r\n            advance(match[0].length)\r\n            let matched = {\r\n                tagName: match[1],\r\n                attrs: []\r\n            }\r\n            //解析属性\r\n            //属性可能有多个，属性的位置 >前的\r\n            let end, attr\r\n            while (!(end = html.match(startTagClose)) && (attr = html.match(attribute))) {\r\n                advance(attr[0].length)\r\n                matched.attrs.push({ name: attr[1], value: attr[3] || attr[4] || attr[5] })\r\n            }\r\n            if (end) {\r\n                advance(end[0].length)\r\n                return matched;\r\n            }\r\n            \r\n        }\r\n    }\r\n\r\n    while (html) {\r\n        // indexOf() 方法可返回某个指定的字符串值在字符串中首次出现的位置。\r\n        let textEnd = html.indexOf('<')\r\n        // 如果textEnd == 0的话，说明是标签； >0的话，说明是文本\r\n        if (textEnd === 0) {\r\n            //开始标签\r\n            let startTagMatch = parseStartTag()\r\n            if(startTagMatch){\r\n                start(startTagMatch.tagName, startTagMatch.attrs)\r\n            }\r\n            //结束标签\r\n            let endTagMatch = html.match(endTag)\r\n            if (endTagMatch) {\r\n                advance(endTagMatch[0].length)\r\n                end(endTagMatch[1])\r\n            }\r\n        }\r\n\r\n        // 匹配文本 从0-匹配到>的位置都是文本的部分\r\n        let text;\r\n        if (textEnd > 0) {\r\n            text = html.substring(0, textEnd)\r\n        }\r\n        if (text) {\r\n            advance(text.length)\r\n            charts(text)\r\n        }\r\n    }\r\n    return root;\r\n}","// 将模板编译成render函数\r\n\r\nimport { generate } from \"./generate\";\r\nimport { parseHTML } from \"./parse\";\r\n\r\n\r\nexport function compileToFunctions(template) {\r\n    // 将html模板转成ast语法树\r\n    let ast = parseHTML(template)\r\n\r\n    // 将ast 转换成code\r\n    let code = generate(ast)\r\n    \r\n    // with生成render代码\r\n    let renderCode = `with(this){ return ${code}}`\r\n\r\n    // 生成render函数\r\n    let fn = new Function(renderCode)\r\n\r\n    return fn\r\n}","\r\n// dep主要用来保存watcher和让watcher更新\r\nlet id = 0;\r\nexport class Dep {\r\n    constructor(){\r\n        this.subs = []\r\n        this.id = id++;\r\n    }\r\n    \r\n    // 让watcher记住这个dep\r\n    depend(){\r\n       Dep.target.addDep(this) \r\n    }\r\n\r\n    //添加一个watcher\r\n    addSub(watcher){\r\n        this.subs.push(watcher)\r\n    }\r\n    //让watcher触发更新\r\n    notify(){\r\n        this.subs.forEach(watcher=>watcher.update())\r\n    }\r\n}   \r\n\r\nDep.target = null; \r\nexport function pushTarget(watcher){\r\n    Dep.target = watcher;\r\n}\r\n\r\nexport function popTarget(){\r\n   Dep.target = null;\r\n}","\r\nlet callbacks = []\r\nlet waiting = false;\r\nfunction flushCallbacks() {\r\n    for (let i = 0; i < callbacks.length; i++) {\r\n        let callback = callbacks[i]\r\n        callback()\r\n    }\r\n    callbacks = []\r\n    waiting = false;\r\n}\r\n// 批处理 只更新列表， 之后执行更新逻辑\r\nexport function nextTick(cb) {\r\n    callbacks.push(cb)\r\n    if (!waiting) {\r\n        waiting = true;\r\n        Promise.resolve().then(flushCallbacks)\r\n    }\r\n\r\n}\r\nconst LIFECYCLE_HOOKS = [\r\n    'beforeCreate',\r\n    'created',\r\n    'beforeMount',\r\n    'mounted',\r\n    'beforeUpdate',\r\n    'updated',\r\n    'beforeDestory',\r\n    'destored'\r\n]\r\n//策略模式\r\nconst strats = {}\r\n//合并生命周期方法\r\n//主要是将生命周期合并成一个数组\r\n//第一次  parentVal是空的  childVal有值\r\n//key肯定是生命周期名字，所以parentVal和childVal至少有一个有值，第一次parentVal为空，所以\r\n//调用这个方法时，childVal肯定有值\r\nfunction mergeHook(parentVal, childVal) {\r\n    if (childVal) {\r\n        if (parentVal) {\r\n            return parentVal.concat(childVal)\r\n        } else {\r\n            return [childVal]\r\n        }\r\n    } else {\r\n        return parentVal\r\n    }\r\n}\r\n//生命周期的处理策略\r\nLIFECYCLE_HOOKS.forEach(hook => {\r\n    strats[hook] = mergeHook // 合并生命周期函数 \r\n})\r\nexport function isObject(val) {\r\n    return typeof val === 'object' && val !== null;\r\n}\r\n\r\n\r\n// 组件compoents的合并策略\r\nstrats.components = function (parentVal, childVal) {\r\n    let res = Object.create(parentVal)\r\n    for(let key in childVal){\r\n        res[key] = childVal[key]\r\n    }\r\n    return res;\r\n}\r\n\r\n\r\n// 合并选项\r\nexport function mergeOptions(parent, child) {\r\n    let options = {}\r\n    //1. 普通属性的合并策略\r\n    //如果父亲有，儿子也有，就用儿子的\r\n    //如果父亲有，儿子没有，就用父亲的\r\n    //如果父亲没有，而儿子有，就用儿子的\r\n    for (let key in parent) {\r\n        mergeField(key)\r\n    }\r\n\r\n    for (let key in child) {\r\n        if (!parent.hasOwnProperty(key)) {\r\n            mergeField(key)\r\n        }\r\n    }\r\n\r\n    function mergeField(key) {\r\n        //key有可能是生命周期钩子 beforecreate created\r\n        //非普通属性的策略模式，钩子函数、directive component\r\n        if (strats[key]) {\r\n            return options[key] = strats[key](parent[key], child[key])\r\n        }\r\n\r\n\r\n        //如果parent[key] child[key]都是对象，就用儿子的覆盖父亲的\r\n        if (isObject(parent[key]) && isObject(child[key])) {\r\n            options[key] = { ...parent[key], ...child[key] }\r\n        } else {\r\n            //合并以儿子为主\r\n            if (child[key]) {\r\n                options[key] = child[key]\r\n            } else {\r\n                options[key] = parent[key]\r\n            }\r\n        }\r\n    }\r\n\r\n    return options;\r\n}\r\n\r\nfunction makeUp(str) {\r\n    let has = {}\r\n    str.split(',').forEach(tagName => {\r\n        has[tagName] = true;\r\n    })\r\n\r\n    return (tag) => has[tag] || false;\r\n}\r\n\r\n// 是否是原生标签 高阶函数\r\nexport const isReservedTag = makeUp('a,p,div,ul,li,span,input,button,b')","import { nextTick } from \"../utils\";\r\n\r\n\r\nlet queue = []\r\nlet has = {}\r\nlet pending = false;\r\n\r\nfunction flushSchedularQueue(){\r\n   for(let i =0; i< queue.length; i++) {\r\n       let watcher = queue[i]\r\n       watcher.run()\r\n   }\r\n   queue = []\r\n   has = {}\r\n   pending = false;\r\n}\r\nexport function queueWatcher(watcher){\r\n    let id = watcher.id;\r\n    if(!has[id]){\r\n        queue.push(watcher)\r\n        has[id] = true;\r\n  \r\n        if(!pending){\r\n            pending = true; //进入等待状态\r\n            //如果不是等待状态,异步执行数组中的watcher\r\n            nextTick(flushSchedularQueue)\r\n        }\r\n    }\r\n}","\r\nimport { pushTarget, popTarget } from './dep'\r\nimport { queueWatcher } from './schedular';\r\nlet id = 0; \r\nclass Watcher{\r\n   constructor(vm, exprOrFn, cb, options){\r\n       this.id = id++;\r\n       this.vm = vm;\r\n       this.cb = cb;\r\n       this.options = options;\r\n       this.getter = exprOrFn;\r\n\r\n       this.deps = []\r\n       this.depsId = new Set() //dep的id  set数据\r\n\r\n       this.get()\r\n   }\r\n   // watcher中保存着dep\r\n   addDep(dep){\r\n      //watcher中不存放相同的dep\r\n      let id = dep.id;\r\n      if(!this.depsId.has(id)){ //dep是非重复的，watcher也是不会重复的\r\n        this.depsId.add(id)\r\n        this.deps.push(dep)\r\n        dep.addSub(this)\r\n      }\r\n   }\r\n   //为什么叫get呢，表示这个方法中会对模板中的数据进行取值\r\n   get(){\r\n      //更新前，将这个watcher(渲染watcher)放到Depd.target属性上\r\n      pushTarget(this) //Dep.target = watcher\r\n      //getter方法走的是更新方法 vm._update(vm._render())\r\n      this.getter() //调用getter方法，会对模板中的数据进行取值操作\r\n      //更新后，重置为null, 防止在模板外修改数据，减少不必要的更新\r\n      popTarget() //Dep.target = null\r\n   }\r\n   //真正的更新方法\r\n   run(){\r\n      this.get()\r\n   }\r\n   //更新操作\r\n   //现在是同步更新，改一次，更新一次，希望是异步更新\r\n   update(){\r\n      //调度执行watcher的更新方法，而且是异步的\r\n      queueWatcher(this)\r\n   }\r\n}\r\n\r\nexport default Watcher;","// 创建组件的真实元素\r\nfunction createComponent(vnode){\r\n    let i = vnode.data\r\n    if((i = i.hook) && (i = i.init)){\r\n         i(vnode)\r\n         if(vnode.componentInstance){\r\n             return true;\r\n         }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction createElm(vnode){\r\n    let {tag, data, key, children, text, vm} = vnode\r\n    if(typeof tag === 'string'){\r\n       \r\n        //可能是组件，也可能是普通的元素\r\n\r\n        if(createComponent(vnode)){ // 返回组件的真实dom节点\r\n            return vnode.componentInstance.$el;\r\n        }\r\n        //创建标签\r\n        //虚拟节点的el属性上映射真实dom\r\n        vnode.el = document.createElement(tag)\r\n        //更新属性\r\n        updateProperties(vnode)\r\n        // 创建子节点\r\n        children.forEach(child => {\r\n            vnode.el.appendChild(createElm(child))\r\n        })\r\n    }else{\r\n        //创建文本\r\n        vnode.el = document.createTextNode(text)\r\n    }\r\n    return vnode.el\r\n}\r\n\r\nfunction updateProperties(vnode){\r\n    let {tag, data, key, children, text, vm} = vnode\r\n    let elm = vnode.el;\r\n    Object.keys(data).forEach(key => {\r\n        if(key === 'style'){\r\n            for(let styleName in data['style']){\r\n                elm.style[styleName] = data['style'][styleName]\r\n            }\r\n        }else if(key === 'class'){\r\n            elm.className = data['class']\r\n        }else {\r\n            elm.setAttribute(key, data[key])\r\n        }\r\n    }) \r\n}\r\nexport function patch(oldVnode, vnode){\r\n    // 组件： oldVnode没有，就直接创建元素\r\n    if(!oldVnode) return createElm(vnode)\r\n    // 初次渲染，oldVnode是#app真实dom节点\r\n    const isRealElement = oldVnode.nodeType;\r\n\r\n    if(isRealElement){\r\n        //初次渲染\r\n        let oldElm = oldVnode; // 老的真实dom节点\r\n        let parentNode = oldElm.parentNode; // 父节点\r\n        let el = createElm(vnode) // 根据虚拟节点创建出真实dom 新的真实dom\r\n        \r\n        //将新的真实dom插入到老的节点下一个节点的前边\r\n        parentNode.insertBefore(el, oldElm.nextSibiling)\r\n\r\n        // 移除老的节点\r\n        parentNode.removeChild(oldElm)\r\n        //返回新的节点\r\n        return el;\r\n    }else{\r\n        //diff\r\n    }\r\n    \r\n}","\r\n// 挂载的逻辑，有了render函数，使用render函数生成vdom虚拟dom，然后渲染到页面上\r\n\r\nimport Watcher from \"./observer/watcher\"\r\nimport { patch } from \"./vdom/patch\";\r\n\r\nexport function lifecycleMixin(Vue) {\r\n    //将虚拟dom转换成真实dom渲染到页面\r\n    Vue.prototype._update = function (vnode) {\r\n        let vm = this;\r\n        // vm.$el是真实dom节点\r\n        vm.$el = patch(vm.$el, vnode)\r\n    }\r\n}\r\n\r\n\r\n// 渲染靠的是watcher  - 渲染watcher\r\nexport function mountComponent(vm, el) {\r\n    // 更新渲染组件的方法\r\n    const updateComponent = () => {\r\n        vm._update(vm._render())\r\n    }\r\n    // 使用渲染watcher渲染页面\r\n    new Watcher(vm, updateComponent, () => { }, true) // true为渲染watcher\r\n}\r\n\r\n/**\r\n * 调用声明周期钩子\r\n * @param {*} vm \r\n * @param {*} hook \r\n */\r\nexport function callHook(vm, hook) {\r\n    //vm.$options上可以获取到合并后的生命周期函数数组\r\n    const handlers = vm.$options[hook]\r\n    if (handlers) {\r\n        handlers.forEach(handler => handler.call(vm))\r\n    }\r\n}","// 数据劫持，数组的处理逻辑，主要是方法的重写\r\n\r\n// 老的数组的方法\r\nlet oldArrayMethods = Array.prototype;\r\n\r\n// 这7个方法都是能修改原数组的方法\r\nconst methods = [\r\n    'push',\r\n    'pop',\r\n    'shift',\r\n    'unshift',\r\n    'splice',\r\n    'reverse',\r\n    'sort'\r\n]\r\n/**\r\n * 相当于\r\n * function create(proto){\r\n *   let Fn = function(){}\r\n *   Fn.prototype = proto\r\n *   return new Fn()\r\n * }\r\n * proto.__proto__ = Array.prototype 相当于多了一层\r\n */\r\nconst arrayMethods = Object.create(Array.prototype)\r\n\r\n// 重写数组的方法\r\n// 删除元素的方法不管，增加元素的方法，如果元素是对象，进行监测\r\nmethods.forEach(method => {\r\n    arrayMethods[method] = function(...args) {\r\n        // 调用老的方法\r\n        let result = oldArrayMethods[method].call(this, ...args)\r\n        let inserted;\r\n        let ob = this.__ob__ // Observer的实例\r\n        // 自己的逻辑\r\n        switch(method){\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted = args;\r\n                break;\r\n            case 'splice':  // splice(0, 1, xxx)\r\n                inserted = args.slice(2)\r\n            default:\r\n                break;\r\n        }\r\n        // 如果有插入的元素\r\n        if(inserted) {\r\n           // inserted是一个数组，数组中可能有插入的对象元素，监测数组\r\n           // 检测数组可以调用Observer的 observeArray 方法，但是需要得到Observer的实例\r\n           // 这里的this是什么，数组调用的方法，this指的是数组数据，可以将Observer实例挂载到this上\r\n           ob.observeArray(inserted)\r\n        }\r\n        //调用了数组的方法，更新视图\r\n        ob.dep.notify()\r\n        return result;\r\n        \r\n    }\r\n})\r\n// 导出重写后的方法\r\nexport default arrayMethods;","import arrayMethods from \"./array\"\r\nimport {Dep} from './dep'\r\nclass Observer {\r\n    constructor(data) { //data有可能是一个数组\r\n        //数组的依赖收集\r\n        this.dep = new Dep()\r\n        //这样写发现死循环了 Maximum call stack size exceeded\r\n        //因为data多了一个__ob__属性，walk的时候，循环data，ob是一个对象，又new Observer，又走walk，又\r\n        //有一个__ob__，就死循环了\r\n        //data.__ob__ = this; // 将this挂载到数据上\r\n        // 将__ob__变成不可枚举即可,使用Object.defineProperty\r\n        Object.defineProperty(data, '__ob__', {\r\n            value: this,\r\n            enumerable: false, //不能枚举\r\n            configurable: false //不能删除\r\n        })\r\n\r\n        // 如果数据是一个数组的话，默认会将数组的每一个元素都设置了get和set，性能差\r\n        // 默认数组单独处理\r\n        if (Array.isArray(data)) {\r\n            // 处理数组的逻辑 这里的data是数组，有数组的方法\r\n            // 1. 改写数组的方法（能修改原数组的方法）,因为如果原数组改变了，也应该触发视图更新\r\n            // 通过重写原型方法的方式 data.__proto__ = arrayMethods\r\n            Object.setPrototypeOf(data, arrayMethods)\r\n            // 2. 如果元素是对象，进行监测，如果是普通值，不管\r\n            this.observeArray(data)\r\n        } else {\r\n            this.walk(data)\r\n        }\r\n    }\r\n\r\n    // 观测数据，走一步\r\n    walk(data) {\r\n        // value是对象\r\n        Object.keys(data).forEach(key => {\r\n            // 定义响应式数据 obj  key  value\r\n            defineReactive(data, key, data[key])\r\n        })\r\n    }\r\n\r\n    // 数组元素监测\r\n    observeArray(data) {\r\n        for (let i = 0; i < data.length; i++) {\r\n            observe(data[i])\r\n        }\r\n    }\r\n}\r\n\r\nfunction dependArray(value){\r\n    for(let i = 0; i < value.length; i++){\r\n        let current = value[i]\r\n        //如果有__ob__属性，说明是对象或者数组，也要收集依赖\r\n        current.__ob__ && current.__ob__.dep.depend()\r\n\r\n        //如果这个元素是数组，递归收集\r\n        if(Array.isArray(current)){\r\n            dependArray(current)\r\n        }\r\n    }\r\n}\r\n\r\n// 将一个对象定义成响应式（Object.defineProperty）\r\nexport function defineReactive(obj, key, value) {\r\n    // value可能是对象\r\n    let childOb = observe(value) //observer的实例\r\n    let dep = new Dep() // 给每个属性都创建一个dep，用于收集依赖\r\n    Object.defineProperty(obj, key, {\r\n        get() {\r\n            //渲染的时候，js单线程机制，模板渲染会进行取值操作，走get方法\r\n            //让这个属性key能记住这个watcher\r\n            if(Dep.target){\r\n                // 对对象进行依赖收集,将Dep.target这个渲染watcher放到这个dep中\r\n                dep.depend() //让这个属性自己的dep记住这个watcher，也要让watcher记住这个dep\r\n                \r\n                if(childOb){ //收集数组或者对象本身的依赖 {arr:[]}\r\n                    childOb.dep.depend()\r\n                    //如果元素中也有数组，也要递归收集，将元素的依赖收集起来\r\n                    if(Array.isArray(value)){\r\n                        dependArray(value)\r\n                    }\r\n                }\r\n                \r\n            }\r\n            return value;\r\n        },\r\n        set(newVal) {\r\n            if (newVal === value) {\r\n                return;\r\n            }\r\n            // 设置的值可能是对象\r\n            observe(newVal)\r\n            value = newVal;\r\n\r\n            dep.notify()\r\n        }\r\n    })\r\n}\r\n\r\n// 观测数据，数据劫持\r\nexport function observe(data) {\r\n    // 如果不是对象的话，不管\r\n    if (typeof data !== 'object' || data === null) {\r\n        return;\r\n    }\r\n    // 如果数据有__ob__属性，说明被监测过了，不用再次监测\r\n    if (data.__ob__) {\r\n        return;\r\n    }\r\n    // 使用Observer类观测\r\n    return new Observer(data)\r\n\r\n}","import { observe } from \"./observer/index.js\";\r\n\r\n// 用于初始化状态，状态由很多种 props data methods computed watch\r\nexport function initState(vm) {\r\n  let options = vm.$options\r\n\r\n  // 初始化数据，数据劫持\r\n  if(options.data){\r\n      initData(vm)\r\n  }\r\n}\r\n\r\n// 将vm._data的数据代理的vm实例上，用户体验好\r\nfunction proxy(target, source, key){\r\n  Object.defineProperty(target, key, {\r\n    get(){\r\n      return target[source][key]\r\n    },\r\n    set(newValue){\r\n      target[source][key] = newValue;\r\n    }\r\n  })\r\n}\r\n\r\n// 初始化data数据\r\nfunction initData(vm) {\r\n    // 初始化数据，就是对数据的劫持\r\n    let data = vm.$options.data\r\n    // vm._data中保存着数据\r\n    data = vm._data = typeof data === 'function' ? data.call(vm): data;\r\n\r\n    // 用户看数据只能在vm._data上看，可以将vm._data上的数据代理到vm实例上，通过vm.xx访问数据\r\n    for(let key in data){\r\n       proxy(vm, '_data', key)\r\n    }\r\n\r\n    // 数据劫持，观测数据 data和vm._data是同一个引用\r\n    observe(data)\r\n\r\n}","import { compileToFunctions } from \"./compiler/index.js\";\r\nimport { callHook, mountComponent } from \"./lifecycle.js\";\r\nimport { mergeOptions, nextTick } from \"./utils.js\";\r\nimport { initState } from \"./state\";\r\n\r\nexport function initMixin(Vue) {\r\n    Vue.prototype._init = function (options) {\r\n        let vm = this;\r\n        // 将用户传入的选项和Vue.options进行合并\r\n        // vm.$options保存的是用户传入的选项\r\n        //将合并后的生命周期啥的配置项和用户传入的options合并，保存到了vm.$options上\r\n        vm.$options = mergeOptions(vm.constructor.options,options)\r\n        console.log(vm.$options,'vm.$options')\r\n        //初始化状态前 beforeCreate\r\n        callHook(vm, 'beforeCreate')\r\n        \r\n        //初始化状态有很多\r\n        initState(vm)\r\n\r\n        //初始化状态后  created\r\n        callHook(vm, 'created')\r\n\r\n        //编译模板，挂载到页面\r\n        if(vm.$options.el){\r\n            vm.$mount(vm.$options.el)\r\n        }\r\n    }\r\n    // nextTick方法\r\n    Vue.prototype.$nextTick = nextTick\r\n\r\n    Vue.prototype.$mount = function(el) {\r\n        const vm = this;\r\n        let options = vm.$options;\r\n        \r\n        // 获取el的dom节点\r\n        el = typeof el === 'string' ? document.querySelector(el) : el;\r\n        // vm.$options.el是真实dom节点\r\n        vm.$el = el;\r\n\r\n        // 查找模板的顺序：\r\n        // 如果有render函数，直接使用render函数\r\n        // 没有render  看看有没有template\r\n        // 没有template 就使用外部模板\r\n\r\n        // 使用模板编译成render函数\r\n        if(!options.render){\r\n            let template = options.template\r\n            if(!template){\r\n                template = el.outerHTML // 外部模板\r\n            }\r\n\r\n            //拿到模板，使用模板编译成render函数\r\n            const render =  compileToFunctions(template)\r\n            options.render = render;\r\n        }\r\n\r\n\r\n        // 有了render函数，挂载页面(组件)\r\n        mountComponent(vm, el)\r\n\r\n    }\r\n}","import { isObject, isReservedTag } from \"../utils\"\r\n\r\n// _c('div', {a:1,b:2}, _c())\r\nexport function createElement(vm, tag, data={}, ...children){\r\n    // 这里的tag有可能是个组件，要区分是组件还是原生标签\r\n    if(isReservedTag(tag)){\r\n        return vnode(vm, tag, data, data.key, children, undefined)\r\n    }else{\r\n        let Ctor = vm.$options.components[tag]\r\n        return createComponent(vm, tag, data, data.key, children, Ctor)\r\n    }\r\n    \r\n}\r\n\r\nfunction createComponent(vm, tag, data, key, children, Ctor){\r\n    // Ctor有可能是一个对象或者函数\r\n    if(isObject(Ctor)){\r\n        Ctor = vm.$options._base.extend(Ctor)\r\n    }\r\n    // 给组件的虚拟dom的属性上添加一个hook生命周期方法\r\n    data.hook = {\r\n        init(vnode){\r\n            let child = vnode.componentInstance = new vnode.componentOptions.Ctor({})\r\n            child.$mount()\r\n        }\r\n    }\r\n    return vnode(vm, `vue-component-${Ctor.cid}-${tag}`, data, key, undefined, undefined, { Ctor })\r\n}\r\n\r\nexport function createTextNode(vm, text){\r\n    return vnode(vm, undefined, undefined, undefined, undefined, text)\r\n}\r\n\r\n\r\nfunction vnode(vm, tag, data, key, children, text, componentOptions){\r\n    return {\r\n        vm,\r\n        tag,\r\n        data,\r\n        key,\r\n        children,\r\n        text,\r\n        componentOptions\r\n    }\r\n}","import { createElement, createTextNode } from \"./vdom/index\"\r\n\r\nexport function renderMixin(Vue) {\r\n    \r\n    Vue.prototype._c = function (...args) {\r\n        return createElement(this, ...args)\r\n    }\r\n    Vue.prototype._v = function (text) {\r\n        return createTextNode(this, text)\r\n    }\r\n    Vue.prototype._s = function (val) {\r\n        return val == null ? '' : typeof val === 'object' ? JSON.stringify(val) : val;\r\n    }\r\n    Vue.prototype._render = function () {\r\n        const vm = this;\r\n        let render = vm.$options.render\r\n        let vnode = render.call(vm)\r\n        return vnode;\r\n    }\r\n}","import { mergeOptions } from \"../utils\";\r\n\r\n\r\nexport function initGlobalAPI(Vue) {\r\n    //用来存储全局的配置\r\n    Vue.options = {}\r\n    //混入，就是将这些配置项混入到用户传入的配置项中\r\n    //调用mixin方法，会将mixin配置项合并到Vue.options选项中\r\n    Vue.mixin = function (mixin) {\r\n        this.options = mergeOptions(this.options, mixin)\r\n        return this;\r\n    }\r\n\r\n\r\n\r\n    Vue.options._base = Vue // 保存Vue构造函数\r\n\r\n    //将所有的组件都保存到这个对象中\r\n    Vue.options.components = {}\r\n\r\n    //component方法\r\n    //Vue.component方法内部调用的Vue.extend方法，传入对象，返回组件的构造函数\r\n    Vue.component = function (id, definition) {\r\n        debugger\r\n        definition.name = definition.name || id;\r\n        //调用extend方法，返回组件的构造函数\r\n        definition = this.options._base.extend(definition)\r\n        //将组件的构造函数保存到Vue.options.components对象中\r\n        this.options.components[id] = definition\r\n    }\r\n    let cid = 0; \r\n    Vue.extend = function (options) {\r\n        debugger\r\n        let Super = this; //Super指向Vue\r\n        //创建Vue子类的构造函数\r\n        let Sub = function VueComponent(options) {\r\n            this._init(options)\r\n        }\r\n        Sub.cid = cid++;\r\n        // 原型继承\r\n        Sub.prototype = Object.create(Super.prototype)\r\n        Sub.prototype.constructor = Sub\r\n\r\n        // 拷贝静态方法\r\n        Sub.component = Super.component;\r\n\r\n        // 每次定义一个组件，这个组件应该能够父级的定义\r\n\r\n        Sub.options = mergeOptions(Super.options, options)\r\n\r\n\r\n        return Sub;\r\n    }\r\n}","import { initMixin } from \"./init\";\r\nimport { renderMixin } from './render'\r\nimport { lifecycleMixin } from './lifecycle'\r\nimport { initGlobalAPI } from \"./global-api/index\";\r\n// Vue的入口文件\r\nfunction Vue (options){\r\n  this._init(options)  \r\n}\r\n\r\n// 混入的初始化方法\r\n// 原型模式，将原型的方法拆分到不同的文件中\r\ninitMixin(Vue)\r\nlifecycleMixin(Vue) //在Vue原型上扩展_update方法\r\nrenderMixin(Vue) // 在Vue原型上扩展_render方法\r\n\r\n\r\ninitGlobalAPI(Vue) //混入全局方法\r\nexport default Vue;"],"names":["defaultTagRE","genChilren","el","children","map","child","gen","join","node","type","text","test","lastIndex","match","index","tokens","exec","push","JSON","stringify","slice","trim","length","generate","genProps","attrs","str","i","attr","name","temp","value","obj","split","forEach","s","sName","sValue","code","tag","ncname","qnameCapture","startTagOpen","RegExp","endTag","attribute","startTagClose","createAstElement","parent","parseHTML","html","root","stack","currentParent","start","tagName","element","end","pop","charts","replace","advance","n","substring","parseStartTag","matched","textEnd","indexOf","startTagMatch","endTagMatch","compileToFunctions","template","ast","renderCode","fn","Function","id","Dep","subs","target","addDep","watcher","update","pushTarget","popTarget","callbacks","waiting","flushCallbacks","callback","nextTick","cb","Promise","resolve","then","LIFECYCLE_HOOKS","strats","mergeHook","parentVal","childVal","concat","hook","isObject","val","components","res","Object","create","key","mergeOptions","options","mergeField","hasOwnProperty","makeUp","has","isReservedTag","queue","pending","flushSchedularQueue","run","queueWatcher","Watcher","vm","exprOrFn","getter","deps","depsId","Set","get","dep","add","addSub","createComponent","vnode","data","init","componentInstance","createElm","$el","document","createElement","updateProperties","appendChild","createTextNode","elm","keys","styleName","style","className","setAttribute","patch","oldVnode","isRealElement","nodeType","oldElm","parentNode","insertBefore","nextSibiling","removeChild","lifecycleMixin","Vue","prototype","_update","mountComponent","updateComponent","_render","callHook","handlers","$options","handler","call","oldArrayMethods","Array","methods","arrayMethods","method","args","result","inserted","ob","__ob__","observeArray","notify","Observer","defineProperty","enumerable","configurable","isArray","setPrototypeOf","walk","defineReactive","observe","dependArray","current","depend","childOb","set","newVal","initState","initData","proxy","source","newValue","_data","initMixin","_init","constructor","console","log","$mount","$nextTick","querySelector","render","outerHTML","undefined","Ctor","_base","extend","componentOptions","cid","renderMixin","_c","_v","_s","initGlobalAPI","mixin","component","definition","Super","Sub","VueComponent"],"mappings":"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"}